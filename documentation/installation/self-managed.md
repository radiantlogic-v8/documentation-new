---
title: Self-managed Deployment
description: Learn how to deploy RadiantOne Identity Data Management in your own Kubernetes cluster using Helm.
---

## Overview

This document provides instructions for deploying RadiantOne Identity Data Management on your Kubernetes cluster using Helm charts. It covers prerequisites, lists the microservices involved, and explains how to access the Identity Data Management control panel on your local machine via port-forwarding.

Self-managed Identity Data Management can be deployed on any Certified Kubernetes cluster (cloud or on-premise). We officially support a variety of providers such as Amazon EKS and Azure AKS. The installation process exclusively utilizes Helm, meaning you will use `helm install` or `helm upgrade` commands.

## Prerequisites

- Install [Kubernetes cluster](https://kubernetes.io/docs/setup/) of version 1.27 or higher. Refer to the [Sizing a Kubernetes cluster](https://developer.radiantlogic.com/idm/v7.4/getting_started/kubernetes/#sizing-a-kubernetes-cluster) document for additional details.
- Install [Helm](https://helm.sh/docs/intro/install/) version 3.0 or higher.
- Install [`kubectl`](https://kubernetes.io/docs/reference/kubectl/) version 1.27 or higher and configure it to access your Kubernetes cluster.
- An Identity Data Management license key, which will be provided to you during onboarding.
- Container Registry Access and image pull credentials, which will be provided to you during onboarding.
- Ensure that you have necessary storage provisioners and storage classes configured for the Kubernetes cluster. Some examples of supported storage classes are `gp2`, [Azure disk](https://learn.microsoft.com/en-us/azure/aks/concepts-storage#persistent-volumes), etc.
- Estimate sufficient resources (CPU, memory, storage) for the deployment. Your Radiant Logic solutions engineer may guide you with this depending on your use case. 

## Steps for Deployment

1. **Get the Identity Data Management Helm chart template**
   ```bash
   helm template oci://ghcr.io/radiantlogic-devops/helm-v8/fid --version 1.1.0
   ```

2. **Download the Helm configuration file named `values.yaml`**
   First, download the default `values.yaml` file included in the Helm chart to your local machine with the command below:
   ```bash
   helm show values oci://ghcr.io/radiantlogic-devops/helm-v8/fid --version 1.1.0
   ```
   In the later steps, you will need to change the values of the properties in the `values.yaml` as appropriate for your requirements.

3. **Include Docker credentials to pull images**

   **Create a .dockerconfigjson in Kubernetes by following these steps:**

   - Create a Docker Configuration JSON File:
     ```json
     {
       "auths": {
         "registry-url": {
           "username": "your-username",
           "password": "your-password",
           "email": "your-email@example.com",
           "auth": "base64-encoded-auth-string"
         }
       }
     }
     ```

     Replace `registry-url` with your registry's URL and fill in your credentials. The `auth` field is a base64-encoded string of `username:password` and can be generated by running the following command:
     ```bash
     echo -n "your-username:your-password" | base64
     ```

   - Base64 Encode the Docker Configuration JSON:
     ```bash
     cat docker-config.json | base64 -w 0
     ```

   - Create the Kubernetes Secret manifest file and save it as `regcred.yaml`:
     ```yaml
     apiVersion: v1
     kind: Secret
     metadata:
       name: regcred
     data:
       .dockerconfigjson: <base64-encoded-string>
     type: kubernetes.io/dockerconfigjson
     ```

     Replace `<base64-encoded-string>` with your actual encoded JSON.

   - Open the `values.yaml` file in a text editor or IDE. Update the value of the `imagePullSecrets` field to specify the secret generated in Step 3:
     ```yaml
     imagePullSecrets:
       - name: regcred
     ```

     This allows Kubernetes to pull private images.

4. **Update Helm configurations based on your requirements**

   In your `values.yaml`, ensure that you have the following properties at minimum. Note that the values of the properties such as `storageClass`, `resources`, etc., will differ depending on your use case, cloud provider, and storage requirements. Work with your Radiant Logic Solution Engineer to customize your Helm configuration.

   **Example `values.yaml` file:**
   ```yaml
   replicaCount: 2
   image:
     tag: 8.1.1
   fid:
     license: >-
       YourLicense
     rootPassword: "Enteryourrootpw"
   imagePullSecrets:
     - name: regcred
   imageCredentials:
     enabled: false
     registry: docker.io
     username: "" # Leave the values of username, password and email empty if you are using imagePullSecrets property.
     password: ""
     email: ""
   persistence:
     enabled: true
     storageClass: "gp3"
     accessModes:
     - ReadWriteOnce
     size: 30Gi
     annotations: {}
   zookeeper:
     persistence:
       enabled: true
       storageClass: "gp3"
   resources:
     limits:
       cpu: 8
       memory: 16Gi
     requests:
       cpu: 4
       memory: 12Gi
   env:
     INSTALL_SAMPLES: true
     FID_REVISION_UPDATE: true
     FID_SERVER_JOPTS: '-Xms2g -Xmx8g'
   metrics:
     enabled: true
     image: radiantone/fid-exporter
     imageTag: latest
     securityContext:
       runAsUser: 0
     annotations: {}
     pushMode: true
     pushGateway: http://prometheus-pushgateway:9091
     pushMetricCron: "* * * * *"
     fluentd:
       enabled: true
       logs:
         vds_server:
           enabled: true
         vds_server_access:
           enabled: true
         vds_events:
           enabled: true
         periodiccache:
           enabled: true
         web:
           enabled: true
         web_access:
           enabled: true
         sync_engine:
           enabled: true
         alerts:
           enabled: true
         adap_access:
           enabled: true
         admin_rest_api_access:
           enabled: true
       aggregators:
         - type: "elasticsearch"
           host: "elasticsearch-master"
           port: "9200"
   ```
   

   **Definitions of the properties:**
   - `replicaCount`: Specifies the number of RadiantOne nodes that will be deployed. Set the value to a minimum of 2 in production environments for high availability.
   - `image.repository`: Specifies the Docker repository for the Identity Data Management image. Set to `radiantone/fid`.
   - `image.tag`: Specifies the version of the Identity Data Management image to install or upgrade to.
   - `fid.rootUser`: Denotes the root user for RadiantOne. Set to `cn=Directory Manager`.
   - `fid.rootPassword`: Denotes the password for the root user. Set to `Welcome1234`.
   - `fid.license`: Set your Identity Data Management license key.
   - `persistence.enabled`: Indicates whether data persistence is enabled. Set to `true` or `false`.
   - `persistence.storageClass`: Defines the storage class for provisioning persistent volumes.
   - `persistence.size`: Specifies the size of the persistent volume for Identity Data Management.
   - `imageCredentials.enabled`: Indicates if credentials for pulling images from a private registry are enabled.
   - `dependencies.zookeeper.enabled`: Specifies if Zookeeper should be deployed as a dependency. Always set to `true`.
   - `zookeeper.persistence.enabled`: Indicates if data persistence is enabled for Zookeeper.
   -  `metrics`: Indicates monitoring data for various RadiantOne components. Refer to the Enable [metrics and logging](https://developer.radiantlogic.com/idm/v8.1/installation/metrics-and-logging/) guide to learn more. 

5. **Create a namespace for your cluster and apply the credentials to that namespace.**
   ```bash
   kubectl create namespace self-managed
   kubectl apply -n self-managed -f regcred.yaml
   ```

6. **Dry run your deployment**
   ```bash
   helm -n self-managed upgrade --install fid oci://ghcr.io/radiantlogic-devops/helm-v8/fid --version 1.1.0 --values values.yaml --set env.INSTALL_SAMPLES=true --debug --dry-run
   ```

   This command will process your YAML config files without deploying anything. If everything looks good, re-run the command without the `--dry-run` parameter. Setting `INSTALL_SAMPLES=true` is optional.

7. **Deploy self-managed Identity Data Management**
   ```bash
   helm -n self-managed upgrade --install fid oci://ghcr.io/radiantlogic-devops/helm-v8/fid --version 1.1.0 --values values.yaml --debug
   ```

8. **Verify deployment**
   ```bash
   kubectl get pod -n self-managed
   ```

   You should see the following pods listed in the output, confirming that the deployment was successful:
   - api-gateway
   - authentication
   - data-catalog
   - directory-browser
   - directory-namespace
   - directory-schema
   - fid-0
   - iddm-proxy
   - iddm-ui
   - settings
   - system-administration
   - zipkin
   - zookeeper-0
   - zookeeper-1
   - zookeeper-2

## Accessing the Control Panel

To access the Identity Data Management control panel, first set up port forwarding for the `iddm-proxy-service` on port 8443:
```bash
kubectl port-forward svc/iddm-proxy-service -n self-managed 8443:443
```

After setting up port forwarding, you can reach the control panel at [https://localhost:8443/login](https://localhost:8443/login).

### Classic Control Panel

If needed, access the classic control panel via [https://localhost:8443/classic](https://localhost:8443/classic) after port-forwarding the `iddm-proxy-service`.

### Accessing the API Service

You can access the API service at [https://localhost:8443/api](https://localhost:8443/api).


### Accessing LDAP/ADAP Service

To access the LDAP/ADAP service, run the following command to port-forward (open another terminal):

> **Note:** Ensure that ports 2389, 2636, 8089, and 8090 are not already in use on your local machine.

```bash
kubectl port-forward svc/fid-app -n iddm-lab 2389 2636 8089 8090
```

- Access the LDAP service at: `ldap://localhost:2389` from your LDAP browser.
- Access the ADAP service at: `http://localhost:8089`.
- Access the LDAPS service at: `ldaps://localhost:2636` from your LDAP browser.
- Access the ADAP (secure) service at: `https://localhost:8090`.

## Updating a Deployment

To update any resources or settings, change the values in `values.yaml` and run the following command:

```bash
helm upgrade --install --namespace=iddm-lab fid oci://ghcr.io/radiantlogic-devops/h
```

## Using Ingress with a Custom Domain

While localhost is useful for local development and testing, a tool like Ingress provides essential features for managing external access, load balancing, SSL/TLS termination, advanced routing, and security in a Kubernetes environment.

If you would like to use Ingress and add a custom domain for your Identity Data Management, here is an example of how you may set it up:

### 1. Create an Ingress Resource

Define an ingress resource to route traffic to the `iddm-proxy-service`. You can use the following example YAML configuration:

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: iddm-ingress
  namespace: iddm-lab
  annotations: #Change this based on your service provider. In this example, we are using Amazon's ALB. 
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing  # Change to 'internal' for internal ALB
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
spec:
  rules:
  - host: your-custom-domain.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: iddm-proxy-service
            port:
              number: 443
  tls:
  - hosts:
    - your-custom-domain.com
    secretName: iddm-tls-secret
```

Replace `your-custom-domain.com` with your actual domain and `iddm-tls-secret` with your TLS secret name.

### 2. Apply the Ingress Resource

Save the YAML configuration to a file (e.g., `iddm-ingress.yaml`) and apply it to the same namespace where you deployed Identity Data Management using:

```bash
kubectl apply -f iddm-ingress.yaml
```

### 3. Update the Values File

Modify the `values.yaml` file to include the desired domain in the `apiGatewayURL`:

```yaml
frontEnd:
  apiGatewayUrl: "https://your-custom-domain.com/api"
  image:
    repository: radiantone/iddm-ui
    tag: "dev"
```

### 4. Update DNS Records

Point your custom domain to the external IP address of your Ingress controller. This typically involves configuring an A record or CNAME record in your domain's DNS settings.

### 5. Access the Control Panel

Once DNS changes propagate, you can access the control panel at: [https://your-custom-domain.com/login](https://your-custom-domain.com/login).

Ensure you have an appropriate TLS certificate for your custom domain. If you are using a certificate management solution like Cert-Manager, ensure it is configured correctly. To learn more about environments and cloud-provider specific setup, refer to these documents: 

* [ALB for Amazon EKS](https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html)
* [Ingress in AKS](https://learn.microsoft.com/en-us/azure/aks/concepts-network-ingress)
